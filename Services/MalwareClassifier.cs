using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

namespace SentinelAI.Services
{
    public class MalwareClassifier
    {
        private readonly LlmClient llm = new();

        public async Task<string> Classify(List<string> yaraHits, List<string> strings)
        {
            var prompt = $@"                         
Classify malware.

YARA Hits:
{string.Join("\n", yaraHits)}

Suspicious Strings:
{string.Join("\n", strings.Take(50))}

Return:
- Probable malware family
- ATT&CK techniques
- Risk level
- Recommended steps
";
            return await llm.AskAsync(prompt);
        }
    }
}
